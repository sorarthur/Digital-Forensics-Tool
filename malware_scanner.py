import hashlib

# load the .txt file containing malicious hashes
def load_malicious_hashes(file_path):
    with open(file_path, 'r') as f:
        return [line.strip() for line in f]
    
# calculate the SHA-256 hash of a file
def calculate_hash(file_path):
    sha256 = hashlib.sha256()
    with open(file_path, 'rb') as f:
        for block in iter(lambda: f.read(4096), b""):
            sha256.update(block)
    return sha256.hexdigest()

# scan a file against the list of malicious hashes
def scan_file(file_path, malicious_hashes):
    file_hash = calculate_hash(file_path)
    if file_hash in malicious_hashes:
        return "Malicious file detected: {file_path} (Hash: {file_hash})", file_hash
    return "File is clean: {file_path} (Hash: {file_hash})", file_hash